//! This code was AUTOGENERATED using the Codama library.
pub mod close_order_row;
pub mod cpi_event_row;
pub mod create_referral_token_account_idempotent_row;
pub mod fill_order_row;
pub mod open_order_row;
pub mod swap2_row;
pub mod swap2_with_destination_native_row;
pub mod swap2_with_destination_row;
pub mod swap_row;
pub mod swap_with_destination_native_row;
pub mod swap_with_destination_row;
pub mod transfer_fee_row;
pub mod transfer_sol_row;
pub mod transfer_to_sponsor_row;
pub mod unwrap_sol_row;
pub mod wrap_sol_row;

pub use self::close_order_row::*;
pub use self::cpi_event_row::*;
pub use self::create_referral_token_account_idempotent_row::*;
pub use self::fill_order_row::*;
pub use self::open_order_row::*;
pub use self::swap2_row::*;
pub use self::swap2_with_destination_native_row::*;
pub use self::swap2_with_destination_row::*;
pub use self::swap_row::*;
pub use self::swap_with_destination_native_row::*;
pub use self::swap_with_destination_row::*;
pub use self::transfer_fee_row::*;
pub use self::transfer_sol_row::*;
pub use self::transfer_to_sponsor_row::*;
pub use self::unwrap_sol_row::*;
pub use self::wrap_sol_row::*;

use super::SwapOrchestratorInstruction;

pub struct SwapOrchestratorInstructionsMigration;

impl sqlx_migrator::Migration<sqlx::Postgres> for SwapOrchestratorInstructionsMigration {
    fn app(&self) -> &str {
        "swap-orchestrator"
    }

    fn name(&self) -> &str {
        "swap_orchestrator_instructions"
    }

    fn operations(&self) -> Vec<Box<dyn sqlx_migrator::Operation<sqlx::Postgres>>> {
        vec![
            Box::new(CloseOrderMigrationOperation),
            Box::new(CreateReferralTokenAccountIdempotentMigrationOperation),
            Box::new(FillOrderMigrationOperation),
            Box::new(OpenOrderMigrationOperation),
            Box::new(SwapMigrationOperation),
            Box::new(Swap2MigrationOperation),
            Box::new(Swap2WithDestinationMigrationOperation),
            Box::new(Swap2WithDestinationNativeMigrationOperation),
            Box::new(SwapWithDestinationMigrationOperation),
            Box::new(SwapWithDestinationNativeMigrationOperation),
            Box::new(TransferFeeMigrationOperation),
            Box::new(TransferSolMigrationOperation),
            Box::new(TransferToSponsorMigrationOperation),
            Box::new(UnwrapSolMigrationOperation),
            Box::new(WrapSolMigrationOperation),
            Box::new(CpiEventMigrationOperation),
        ]
    }

    fn parents(&self) -> Vec<Box<dyn sqlx_migrator::Migration<sqlx::Postgres>>> {
        vec![]
    }
}

pub struct SwapOrchestratorInstructionWithMetadata(
    pub SwapOrchestratorInstruction,
    pub carbon_core::instruction::InstructionMetadata,
);

impl
    From<(
        SwapOrchestratorInstruction,
        carbon_core::instruction::InstructionMetadata,
    )> for SwapOrchestratorInstructionWithMetadata
{
    fn from(
        value: (
            SwapOrchestratorInstruction,
            carbon_core::instruction::InstructionMetadata,
        ),
    ) -> Self {
        SwapOrchestratorInstructionWithMetadata(value.0, value.1)
    }
}

#[async_trait::async_trait]
impl carbon_core::postgres::operations::Insert for SwapOrchestratorInstructionWithMetadata {
    async fn insert(&self, pool: &sqlx::PgPool) -> carbon_core::error::CarbonResult<()> {
        let SwapOrchestratorInstructionWithMetadata(instruction, metadata) = self;
        match instruction {
            SwapOrchestratorInstruction::CloseOrder(instruction) => {
                let row = close_order_row::CloseOrderRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            SwapOrchestratorInstruction::CreateReferralTokenAccountIdempotent(instruction) => {
                let row = create_referral_token_account_idempotent_row::CreateReferralTokenAccountIdempotentRow::from_parts(instruction.clone(), metadata.clone());
                row.insert(pool).await?;
                Ok(())
            }
            SwapOrchestratorInstruction::FillOrder(instruction) => {
                let row =
                    fill_order_row::FillOrderRow::from_parts(instruction.clone(), metadata.clone());
                row.insert(pool).await?;
                Ok(())
            }
            SwapOrchestratorInstruction::OpenOrder(instruction) => {
                let row =
                    open_order_row::OpenOrderRow::from_parts(instruction.clone(), metadata.clone());
                row.insert(pool).await?;
                Ok(())
            }
            SwapOrchestratorInstruction::Swap(instruction) => {
                let row = swap_row::SwapRow::from_parts(instruction.clone(), metadata.clone());
                row.insert(pool).await?;
                Ok(())
            }
            SwapOrchestratorInstruction::Swap2(instruction) => {
                let row = swap2_row::Swap2Row::from_parts(instruction.clone(), metadata.clone());
                row.insert(pool).await?;
                Ok(())
            }
            SwapOrchestratorInstruction::Swap2WithDestination(instruction) => {
                let row = swap2_with_destination_row::Swap2WithDestinationRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            SwapOrchestratorInstruction::Swap2WithDestinationNative(instruction) => {
                let row =
                    swap2_with_destination_native_row::Swap2WithDestinationNativeRow::from_parts(
                        instruction.clone(),
                        metadata.clone(),
                    );
                row.insert(pool).await?;
                Ok(())
            }
            SwapOrchestratorInstruction::SwapWithDestination(instruction) => {
                let row = swap_with_destination_row::SwapWithDestinationRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            SwapOrchestratorInstruction::SwapWithDestinationNative(instruction) => {
                let row =
                    swap_with_destination_native_row::SwapWithDestinationNativeRow::from_parts(
                        instruction.clone(),
                        metadata.clone(),
                    );
                row.insert(pool).await?;
                Ok(())
            }
            SwapOrchestratorInstruction::TransferFee(instruction) => {
                let row = transfer_fee_row::TransferFeeRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            SwapOrchestratorInstruction::TransferSol(instruction) => {
                let row = transfer_sol_row::TransferSolRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            SwapOrchestratorInstruction::TransferToSponsor(instruction) => {
                let row = transfer_to_sponsor_row::TransferToSponsorRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            SwapOrchestratorInstruction::UnwrapSol(instruction) => {
                let row =
                    unwrap_sol_row::UnwrapSolRow::from_parts(instruction.clone(), metadata.clone());
                row.insert(pool).await?;
                Ok(())
            }
            SwapOrchestratorInstruction::WrapSol(instruction) => {
                let row =
                    wrap_sol_row::WrapSolRow::from_parts(instruction.clone(), metadata.clone());
                row.insert(pool).await?;
                Ok(())
            }
            SwapOrchestratorInstruction::CpiEvent(instruction) => {
                let row =
                    cpi_event_row::CpiEventRow::from_parts(instruction.clone(), metadata.clone());
                row.insert(pool).await?;
                Ok(())
            }
        }
    }
}

#[async_trait::async_trait]
impl carbon_core::postgres::operations::Upsert for SwapOrchestratorInstructionWithMetadata {
    async fn upsert(&self, pool: &sqlx::PgPool) -> carbon_core::error::CarbonResult<()> {
        let SwapOrchestratorInstructionWithMetadata(instruction, metadata) = self;
        match instruction {
            SwapOrchestratorInstruction::CloseOrder(instruction) => {
                let row = close_order_row::CloseOrderRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            SwapOrchestratorInstruction::CreateReferralTokenAccountIdempotent(instruction) => {
                let row = create_referral_token_account_idempotent_row::CreateReferralTokenAccountIdempotentRow::from_parts(instruction.clone(), metadata.clone());
                row.upsert(pool).await?;
                Ok(())
            }
            SwapOrchestratorInstruction::FillOrder(instruction) => {
                let row =
                    fill_order_row::FillOrderRow::from_parts(instruction.clone(), metadata.clone());
                row.upsert(pool).await?;
                Ok(())
            }
            SwapOrchestratorInstruction::OpenOrder(instruction) => {
                let row =
                    open_order_row::OpenOrderRow::from_parts(instruction.clone(), metadata.clone());
                row.upsert(pool).await?;
                Ok(())
            }
            SwapOrchestratorInstruction::Swap(instruction) => {
                let row = swap_row::SwapRow::from_parts(instruction.clone(), metadata.clone());
                row.upsert(pool).await?;
                Ok(())
            }
            SwapOrchestratorInstruction::Swap2(instruction) => {
                let row = swap2_row::Swap2Row::from_parts(instruction.clone(), metadata.clone());
                row.upsert(pool).await?;
                Ok(())
            }
            SwapOrchestratorInstruction::Swap2WithDestination(instruction) => {
                let row = swap2_with_destination_row::Swap2WithDestinationRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            SwapOrchestratorInstruction::Swap2WithDestinationNative(instruction) => {
                let row =
                    swap2_with_destination_native_row::Swap2WithDestinationNativeRow::from_parts(
                        instruction.clone(),
                        metadata.clone(),
                    );
                row.upsert(pool).await?;
                Ok(())
            }
            SwapOrchestratorInstruction::SwapWithDestination(instruction) => {
                let row = swap_with_destination_row::SwapWithDestinationRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            SwapOrchestratorInstruction::SwapWithDestinationNative(instruction) => {
                let row =
                    swap_with_destination_native_row::SwapWithDestinationNativeRow::from_parts(
                        instruction.clone(),
                        metadata.clone(),
                    );
                row.upsert(pool).await?;
                Ok(())
            }
            SwapOrchestratorInstruction::TransferFee(instruction) => {
                let row = transfer_fee_row::TransferFeeRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            SwapOrchestratorInstruction::TransferSol(instruction) => {
                let row = transfer_sol_row::TransferSolRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            SwapOrchestratorInstruction::TransferToSponsor(instruction) => {
                let row = transfer_to_sponsor_row::TransferToSponsorRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            SwapOrchestratorInstruction::UnwrapSol(instruction) => {
                let row =
                    unwrap_sol_row::UnwrapSolRow::from_parts(instruction.clone(), metadata.clone());
                row.upsert(pool).await?;
                Ok(())
            }
            SwapOrchestratorInstruction::WrapSol(instruction) => {
                let row =
                    wrap_sol_row::WrapSolRow::from_parts(instruction.clone(), metadata.clone());
                row.upsert(pool).await?;
                Ok(())
            }
            SwapOrchestratorInstruction::CpiEvent(instruction) => {
                let row =
                    cpi_event_row::CpiEventRow::from_parts(instruction.clone(), metadata.clone());
                row.upsert(pool).await?;
                Ok(())
            }
        }
    }
}
