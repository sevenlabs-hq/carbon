//! This code was AUTOGENERATED using the Codama library.
pub mod add_liquidity_row;
pub mod claim_partner_fee_row;
pub mod claim_position_fee_row;
pub mod claim_protocol_fee_row;
pub mod claim_reward_row;
pub mod close_config_row;
pub mod close_operator_account_row;
pub mod close_position_row;
pub mod close_token_badge_row;
pub mod cpi_event_row;
pub mod create_config_row;
pub mod create_dynamic_config_row;
pub mod create_operator_account_row;
pub mod create_position_row;
pub mod create_token_badge_row;
pub mod dummy_ix_row;
pub mod fund_reward_row;
pub mod initialize_customizable_pool_row;
pub mod initialize_pool_row;
pub mod initialize_pool_with_dynamic_config_row;
pub mod initialize_reward_row;
pub mod lock_position_row;
pub mod permanent_lock_position_row;
pub mod refresh_vesting_row;
pub mod remove_all_liquidity_row;
pub mod remove_liquidity_row;
pub mod set_pool_status_row;
pub mod split_position2_row;
pub mod split_position_row;
pub mod swap2_row;
pub mod swap_row;
pub mod update_pool_fees_row;
pub mod update_reward_duration_row;
pub mod update_reward_funder_row;
pub mod withdraw_ineligible_reward_row;

pub use self::{
    add_liquidity_row::*, claim_partner_fee_row::*, claim_position_fee_row::*,
    claim_protocol_fee_row::*, claim_reward_row::*, close_config_row::*,
    close_operator_account_row::*, close_position_row::*, close_token_badge_row::*,
    cpi_event_row::*, create_config_row::*, create_dynamic_config_row::*,
    create_operator_account_row::*, create_position_row::*, create_token_badge_row::*,
    dummy_ix_row::*, fund_reward_row::*, initialize_customizable_pool_row::*,
    initialize_pool_row::*, initialize_pool_with_dynamic_config_row::*, initialize_reward_row::*,
    lock_position_row::*, permanent_lock_position_row::*, refresh_vesting_row::*,
    remove_all_liquidity_row::*, remove_liquidity_row::*, set_pool_status_row::*,
    split_position2_row::*, split_position_row::*, swap2_row::*, swap_row::*,
    update_pool_fees_row::*, update_reward_duration_row::*, update_reward_funder_row::*,
    withdraw_ineligible_reward_row::*,
};
use super::MeteoraDammV2Instruction;

pub struct MeteoraDammV2InstructionsMigration;

impl sqlx_migrator::Migration<sqlx::Postgres> for MeteoraDammV2InstructionsMigration {
    fn app(&self) -> &str {
        "meteora-damm-v2"
    }

    fn name(&self) -> &str {
        "meteora_damm_v2_instructions"
    }

    fn operations(&self) -> Vec<Box<dyn sqlx_migrator::Operation<sqlx::Postgres>>> {
        vec![
            Box::new(AddLiquidityMigrationOperation),
            Box::new(ClaimPartnerFeeMigrationOperation),
            Box::new(ClaimPositionFeeMigrationOperation),
            Box::new(ClaimProtocolFeeMigrationOperation),
            Box::new(ClaimRewardMigrationOperation),
            Box::new(CloseConfigMigrationOperation),
            Box::new(CloseOperatorAccountMigrationOperation),
            Box::new(ClosePositionMigrationOperation),
            Box::new(CloseTokenBadgeMigrationOperation),
            Box::new(CreateConfigMigrationOperation),
            Box::new(CreateDynamicConfigMigrationOperation),
            Box::new(CreateOperatorAccountMigrationOperation),
            Box::new(CreatePositionMigrationOperation),
            Box::new(CreateTokenBadgeMigrationOperation),
            Box::new(DummyIxMigrationOperation),
            Box::new(FundRewardMigrationOperation),
            Box::new(InitializeCustomizablePoolMigrationOperation),
            Box::new(InitializePoolMigrationOperation),
            Box::new(InitializePoolWithDynamicConfigMigrationOperation),
            Box::new(InitializeRewardMigrationOperation),
            Box::new(LockPositionMigrationOperation),
            Box::new(PermanentLockPositionMigrationOperation),
            Box::new(RefreshVestingMigrationOperation),
            Box::new(RemoveAllLiquidityMigrationOperation),
            Box::new(RemoveLiquidityMigrationOperation),
            Box::new(SetPoolStatusMigrationOperation),
            Box::new(SplitPositionMigrationOperation),
            Box::new(SplitPosition2MigrationOperation),
            Box::new(SwapMigrationOperation),
            Box::new(Swap2MigrationOperation),
            Box::new(UpdatePoolFeesMigrationOperation),
            Box::new(UpdateRewardDurationMigrationOperation),
            Box::new(UpdateRewardFunderMigrationOperation),
            Box::new(WithdrawIneligibleRewardMigrationOperation),
            Box::new(CpiEventMigrationOperation),
        ]
    }

    fn parents(&self) -> Vec<Box<dyn sqlx_migrator::Migration<sqlx::Postgres>>> {
        vec![]
    }
}

pub struct MeteoraDammV2InstructionWithMetadata(
    pub MeteoraDammV2Instruction,
    pub carbon_core::instruction::InstructionMetadata,
    pub Vec<solana_instruction::AccountMeta>,
);

impl
    From<(
        MeteoraDammV2Instruction,
        carbon_core::instruction::InstructionMetadata,
        Vec<solana_instruction::AccountMeta>,
    )> for MeteoraDammV2InstructionWithMetadata
{
    fn from(
        value: (
            MeteoraDammV2Instruction,
            carbon_core::instruction::InstructionMetadata,
            Vec<solana_instruction::AccountMeta>,
        ),
    ) -> Self {
        MeteoraDammV2InstructionWithMetadata(value.0, value.1, value.2)
    }
}

#[async_trait::async_trait]
impl carbon_core::postgres::operations::Insert for MeteoraDammV2InstructionWithMetadata {
    async fn insert(&self, pool: &sqlx::PgPool) -> carbon_core::error::CarbonResult<()> {
        let MeteoraDammV2InstructionWithMetadata(instruction, metadata, accounts) = self;
        match instruction {
            MeteoraDammV2Instruction::AddLiquidity(instruction) => {
                let row = add_liquidity_row::AddLiquidityRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::ClaimPartnerFee(instruction) => {
                let row = claim_partner_fee_row::ClaimPartnerFeeRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::ClaimPositionFee(instruction) => {
                let row = claim_position_fee_row::ClaimPositionFeeRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::ClaimProtocolFee(instruction) => {
                let row = claim_protocol_fee_row::ClaimProtocolFeeRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::ClaimReward(instruction) => {
                let row = claim_reward_row::ClaimRewardRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::CloseConfig(instruction) => {
                let row = close_config_row::CloseConfigRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::CloseOperatorAccount(instruction) => {
                let row = close_operator_account_row::CloseOperatorAccountRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::ClosePosition(instruction) => {
                let row = close_position_row::ClosePositionRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::CloseTokenBadge(instruction) => {
                let row = close_token_badge_row::CloseTokenBadgeRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::CreateConfig(instruction) => {
                let row = create_config_row::CreateConfigRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::CreateDynamicConfig(instruction) => {
                let row = create_dynamic_config_row::CreateDynamicConfigRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::CreateOperatorAccount(instruction) => {
                let row = create_operator_account_row::CreateOperatorAccountRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::CreatePosition(instruction) => {
                let row = create_position_row::CreatePositionRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::CreateTokenBadge(instruction) => {
                let row = create_token_badge_row::CreateTokenBadgeRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::DummyIx(instruction) => {
                let row = dummy_ix_row::DummyIxRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::FundReward(instruction) => {
                let row = fund_reward_row::FundRewardRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::InitializeCustomizablePool(instruction) => {
                let row =
                    initialize_customizable_pool_row::InitializeCustomizablePoolRow::from_parts(
                        instruction.clone(),
                        metadata.clone(),
                        accounts.clone(),
                    );
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::InitializePool(instruction) => {
                let row = initialize_pool_row::InitializePoolRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::InitializePoolWithDynamicConfig(instruction) => {
                let row = initialize_pool_with_dynamic_config_row::InitializePoolWithDynamicConfigRow::from_parts(instruction.clone(), metadata.clone(), accounts.clone());
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::InitializeReward(instruction) => {
                let row = initialize_reward_row::InitializeRewardRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::LockPosition(instruction) => {
                let row = lock_position_row::LockPositionRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::PermanentLockPosition(instruction) => {
                let row = permanent_lock_position_row::PermanentLockPositionRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::RefreshVesting(instruction) => {
                let row = refresh_vesting_row::RefreshVestingRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::RemoveAllLiquidity(instruction) => {
                let row = remove_all_liquidity_row::RemoveAllLiquidityRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::RemoveLiquidity(instruction) => {
                let row = remove_liquidity_row::RemoveLiquidityRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::SetPoolStatus(instruction) => {
                let row = set_pool_status_row::SetPoolStatusRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::SplitPosition(instruction) => {
                let row = split_position_row::SplitPositionRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::SplitPosition2(instruction) => {
                let row = split_position2_row::SplitPosition2Row::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::Swap(instruction) => {
                let row = swap_row::SwapRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::Swap2(instruction) => {
                let row = swap2_row::Swap2Row::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::UpdatePoolFees(instruction) => {
                let row = update_pool_fees_row::UpdatePoolFeesRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::UpdateRewardDuration(instruction) => {
                let row = update_reward_duration_row::UpdateRewardDurationRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::UpdateRewardFunder(instruction) => {
                let row = update_reward_funder_row::UpdateRewardFunderRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::WithdrawIneligibleReward(instruction) => {
                let row = withdraw_ineligible_reward_row::WithdrawIneligibleRewardRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::CpiEvent(instruction) => {
                let row = cpi_event_row::CpiEventRow::from_parts(
                    (**instruction).clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
        }
    }
}

#[async_trait::async_trait]
impl carbon_core::postgres::operations::Upsert for MeteoraDammV2InstructionWithMetadata {
    async fn upsert(&self, pool: &sqlx::PgPool) -> carbon_core::error::CarbonResult<()> {
        let MeteoraDammV2InstructionWithMetadata(instruction, metadata, accounts) = self;
        match instruction {
            MeteoraDammV2Instruction::AddLiquidity(instruction) => {
                let row = add_liquidity_row::AddLiquidityRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::ClaimPartnerFee(instruction) => {
                let row = claim_partner_fee_row::ClaimPartnerFeeRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::ClaimPositionFee(instruction) => {
                let row = claim_position_fee_row::ClaimPositionFeeRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::ClaimProtocolFee(instruction) => {
                let row = claim_protocol_fee_row::ClaimProtocolFeeRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::ClaimReward(instruction) => {
                let row = claim_reward_row::ClaimRewardRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::CloseConfig(instruction) => {
                let row = close_config_row::CloseConfigRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::CloseOperatorAccount(instruction) => {
                let row = close_operator_account_row::CloseOperatorAccountRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::ClosePosition(instruction) => {
                let row = close_position_row::ClosePositionRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::CloseTokenBadge(instruction) => {
                let row = close_token_badge_row::CloseTokenBadgeRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::CreateConfig(instruction) => {
                let row = create_config_row::CreateConfigRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::CreateDynamicConfig(instruction) => {
                let row = create_dynamic_config_row::CreateDynamicConfigRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::CreateOperatorAccount(instruction) => {
                let row = create_operator_account_row::CreateOperatorAccountRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::CreatePosition(instruction) => {
                let row = create_position_row::CreatePositionRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::CreateTokenBadge(instruction) => {
                let row = create_token_badge_row::CreateTokenBadgeRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::DummyIx(instruction) => {
                let row = dummy_ix_row::DummyIxRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::FundReward(instruction) => {
                let row = fund_reward_row::FundRewardRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::InitializeCustomizablePool(instruction) => {
                let row =
                    initialize_customizable_pool_row::InitializeCustomizablePoolRow::from_parts(
                        instruction.clone(),
                        metadata.clone(),
                        accounts.clone(),
                    );
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::InitializePool(instruction) => {
                let row = initialize_pool_row::InitializePoolRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::InitializePoolWithDynamicConfig(instruction) => {
                let row = initialize_pool_with_dynamic_config_row::InitializePoolWithDynamicConfigRow::from_parts(instruction.clone(), metadata.clone(), accounts.clone());
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::InitializeReward(instruction) => {
                let row = initialize_reward_row::InitializeRewardRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::LockPosition(instruction) => {
                let row = lock_position_row::LockPositionRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::PermanentLockPosition(instruction) => {
                let row = permanent_lock_position_row::PermanentLockPositionRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::RefreshVesting(instruction) => {
                let row = refresh_vesting_row::RefreshVestingRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::RemoveAllLiquidity(instruction) => {
                let row = remove_all_liquidity_row::RemoveAllLiquidityRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::RemoveLiquidity(instruction) => {
                let row = remove_liquidity_row::RemoveLiquidityRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::SetPoolStatus(instruction) => {
                let row = set_pool_status_row::SetPoolStatusRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::SplitPosition(instruction) => {
                let row = split_position_row::SplitPositionRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::SplitPosition2(instruction) => {
                let row = split_position2_row::SplitPosition2Row::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::Swap(instruction) => {
                let row = swap_row::SwapRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::Swap2(instruction) => {
                let row = swap2_row::Swap2Row::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::UpdatePoolFees(instruction) => {
                let row = update_pool_fees_row::UpdatePoolFeesRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::UpdateRewardDuration(instruction) => {
                let row = update_reward_duration_row::UpdateRewardDurationRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::UpdateRewardFunder(instruction) => {
                let row = update_reward_funder_row::UpdateRewardFunderRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::WithdrawIneligibleReward(instruction) => {
                let row = withdraw_ineligible_reward_row::WithdrawIneligibleRewardRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MeteoraDammV2Instruction::CpiEvent(instruction) => {
                let row = cpi_event_row::CpiEventRow::from_parts(
                    (**instruction).clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
        }
    }
}
