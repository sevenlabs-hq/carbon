//! This code was AUTOGENERATED using the Codama library.
pub mod change_status_row;
pub mod claim_row;
pub mod close_claim_account_row;
pub mod collect_revenue_row;
pub mod cpi_event_row;
pub mod init_claim_account_row;
pub mod init_liquidity_row;
pub mod init_new_protocol_row;
pub mod init_token_reserve_row;
pub mod operate_row;
pub mod pause_user_row;
pub mod pre_operate_row;
pub mod unpause_user_row;
pub mod update_authority_row;
pub mod update_auths_row;
pub mod update_exchange_price_row;
pub mod update_guardians_row;
pub mod update_rate_data_v1_row;
pub mod update_rate_data_v2_row;
pub mod update_revenue_collector_row;
pub mod update_token_config_row;
pub mod update_user_borrow_config_row;
pub mod update_user_class_row;
pub mod update_user_supply_config_row;
pub mod update_user_withdrawal_limit_row;

pub use self::{
    change_status_row::*, claim_row::*, close_claim_account_row::*, collect_revenue_row::*,
    cpi_event_row::*, init_claim_account_row::*, init_liquidity_row::*, init_new_protocol_row::*,
    init_token_reserve_row::*, operate_row::*, pause_user_row::*, pre_operate_row::*,
    unpause_user_row::*, update_authority_row::*, update_auths_row::*,
    update_exchange_price_row::*, update_guardians_row::*, update_rate_data_v1_row::*,
    update_rate_data_v2_row::*, update_revenue_collector_row::*, update_token_config_row::*,
    update_user_borrow_config_row::*, update_user_class_row::*, update_user_supply_config_row::*,
    update_user_withdrawal_limit_row::*,
};
use super::LiquidityInstruction;

pub struct LiquidityInstructionsMigration;

impl sqlx_migrator::Migration<sqlx::Postgres> for LiquidityInstructionsMigration {
    fn app(&self) -> &str {
        "liquidity"
    }

    fn name(&self) -> &str {
        "liquidity_instructions"
    }

    fn operations(&self) -> Vec<Box<dyn sqlx_migrator::Operation<sqlx::Postgres>>> {
        vec![
            Box::new(ChangeStatusMigrationOperation),
            Box::new(ClaimMigrationOperation),
            Box::new(CloseClaimAccountMigrationOperation),
            Box::new(CollectRevenueMigrationOperation),
            Box::new(InitClaimAccountMigrationOperation),
            Box::new(InitLiquidityMigrationOperation),
            Box::new(InitNewProtocolMigrationOperation),
            Box::new(InitTokenReserveMigrationOperation),
            Box::new(OperateMigrationOperation),
            Box::new(PauseUserMigrationOperation),
            Box::new(PreOperateMigrationOperation),
            Box::new(UnpauseUserMigrationOperation),
            Box::new(UpdateAuthorityMigrationOperation),
            Box::new(UpdateAuthsMigrationOperation),
            Box::new(UpdateExchangePriceMigrationOperation),
            Box::new(UpdateGuardiansMigrationOperation),
            Box::new(UpdateRateDataV1MigrationOperation),
            Box::new(UpdateRateDataV2MigrationOperation),
            Box::new(UpdateRevenueCollectorMigrationOperation),
            Box::new(UpdateTokenConfigMigrationOperation),
            Box::new(UpdateUserBorrowConfigMigrationOperation),
            Box::new(UpdateUserClassMigrationOperation),
            Box::new(UpdateUserSupplyConfigMigrationOperation),
            Box::new(UpdateUserWithdrawalLimitMigrationOperation),
            Box::new(CpiEventMigrationOperation),
        ]
    }

    fn parents(&self) -> Vec<Box<dyn sqlx_migrator::Migration<sqlx::Postgres>>> {
        vec![]
    }
}

pub struct LiquidityInstructionWithMetadata(
    pub LiquidityInstruction,
    pub carbon_core::instruction::InstructionMetadata,
    pub Vec<solana_instruction::AccountMeta>,
);

impl
    From<(
        LiquidityInstruction,
        carbon_core::instruction::InstructionMetadata,
        Vec<solana_instruction::AccountMeta>,
    )> for LiquidityInstructionWithMetadata
{
    fn from(
        value: (
            LiquidityInstruction,
            carbon_core::instruction::InstructionMetadata,
            Vec<solana_instruction::AccountMeta>,
        ),
    ) -> Self {
        LiquidityInstructionWithMetadata(value.0, value.1, value.2)
    }
}

#[async_trait::async_trait]
impl carbon_core::postgres::operations::Insert for LiquidityInstructionWithMetadata {
    async fn insert(&self, pool: &sqlx::PgPool) -> carbon_core::error::CarbonResult<()> {
        let LiquidityInstructionWithMetadata(instruction, metadata, accounts) = self;
        match instruction {
            LiquidityInstruction::ChangeStatus(instruction) => {
                let row = change_status_row::ChangeStatusRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::Claim(instruction) => {
                let row = claim_row::ClaimRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::CloseClaimAccount(instruction) => {
                let row = close_claim_account_row::CloseClaimAccountRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::CollectRevenue(instruction) => {
                let row = collect_revenue_row::CollectRevenueRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::InitClaimAccount(instruction) => {
                let row = init_claim_account_row::InitClaimAccountRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::InitLiquidity(instruction) => {
                let row = init_liquidity_row::InitLiquidityRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::InitNewProtocol(instruction) => {
                let row = init_new_protocol_row::InitNewProtocolRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::InitTokenReserve(instruction) => {
                let row = init_token_reserve_row::InitTokenReserveRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::Operate(instruction) => {
                let row = operate_row::OperateRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::PauseUser(instruction) => {
                let row = pause_user_row::PauseUserRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::PreOperate(instruction) => {
                let row = pre_operate_row::PreOperateRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::UnpauseUser(instruction) => {
                let row = unpause_user_row::UnpauseUserRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::UpdateAuthority(instruction) => {
                let row = update_authority_row::UpdateAuthorityRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::UpdateAuths(instruction) => {
                let row = update_auths_row::UpdateAuthsRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::UpdateExchangePrice(instruction) => {
                let row = update_exchange_price_row::UpdateExchangePriceRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::UpdateGuardians(instruction) => {
                let row = update_guardians_row::UpdateGuardiansRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::UpdateRateDataV1(instruction) => {
                let row = update_rate_data_v1_row::UpdateRateDataV1Row::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::UpdateRateDataV2(instruction) => {
                let row = update_rate_data_v2_row::UpdateRateDataV2Row::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::UpdateRevenueCollector(instruction) => {
                let row = update_revenue_collector_row::UpdateRevenueCollectorRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::UpdateTokenConfig(instruction) => {
                let row = update_token_config_row::UpdateTokenConfigRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::UpdateUserBorrowConfig(instruction) => {
                let row = update_user_borrow_config_row::UpdateUserBorrowConfigRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::UpdateUserClass(instruction) => {
                let row = update_user_class_row::UpdateUserClassRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::UpdateUserSupplyConfig(instruction) => {
                let row = update_user_supply_config_row::UpdateUserSupplyConfigRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::UpdateUserWithdrawalLimit(instruction) => {
                let row =
                    update_user_withdrawal_limit_row::UpdateUserWithdrawalLimitRow::from_parts(
                        instruction.clone(),
                        metadata.clone(),
                        accounts.clone(),
                    );
                row.insert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::CpiEvent(instruction) => {
                let row = cpi_event_row::CpiEventRow::from_parts(
                    (**instruction).clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
        }
    }
}

#[async_trait::async_trait]
impl carbon_core::postgres::operations::Upsert for LiquidityInstructionWithMetadata {
    async fn upsert(&self, pool: &sqlx::PgPool) -> carbon_core::error::CarbonResult<()> {
        let LiquidityInstructionWithMetadata(instruction, metadata, accounts) = self;
        match instruction {
            LiquidityInstruction::ChangeStatus(instruction) => {
                let row = change_status_row::ChangeStatusRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::Claim(instruction) => {
                let row = claim_row::ClaimRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::CloseClaimAccount(instruction) => {
                let row = close_claim_account_row::CloseClaimAccountRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::CollectRevenue(instruction) => {
                let row = collect_revenue_row::CollectRevenueRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::InitClaimAccount(instruction) => {
                let row = init_claim_account_row::InitClaimAccountRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::InitLiquidity(instruction) => {
                let row = init_liquidity_row::InitLiquidityRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::InitNewProtocol(instruction) => {
                let row = init_new_protocol_row::InitNewProtocolRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::InitTokenReserve(instruction) => {
                let row = init_token_reserve_row::InitTokenReserveRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::Operate(instruction) => {
                let row = operate_row::OperateRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::PauseUser(instruction) => {
                let row = pause_user_row::PauseUserRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::PreOperate(instruction) => {
                let row = pre_operate_row::PreOperateRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::UnpauseUser(instruction) => {
                let row = unpause_user_row::UnpauseUserRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::UpdateAuthority(instruction) => {
                let row = update_authority_row::UpdateAuthorityRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::UpdateAuths(instruction) => {
                let row = update_auths_row::UpdateAuthsRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::UpdateExchangePrice(instruction) => {
                let row = update_exchange_price_row::UpdateExchangePriceRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::UpdateGuardians(instruction) => {
                let row = update_guardians_row::UpdateGuardiansRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::UpdateRateDataV1(instruction) => {
                let row = update_rate_data_v1_row::UpdateRateDataV1Row::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::UpdateRateDataV2(instruction) => {
                let row = update_rate_data_v2_row::UpdateRateDataV2Row::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::UpdateRevenueCollector(instruction) => {
                let row = update_revenue_collector_row::UpdateRevenueCollectorRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::UpdateTokenConfig(instruction) => {
                let row = update_token_config_row::UpdateTokenConfigRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::UpdateUserBorrowConfig(instruction) => {
                let row = update_user_borrow_config_row::UpdateUserBorrowConfigRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::UpdateUserClass(instruction) => {
                let row = update_user_class_row::UpdateUserClassRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::UpdateUserSupplyConfig(instruction) => {
                let row = update_user_supply_config_row::UpdateUserSupplyConfigRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::UpdateUserWithdrawalLimit(instruction) => {
                let row =
                    update_user_withdrawal_limit_row::UpdateUserWithdrawalLimitRow::from_parts(
                        instruction.clone(),
                        metadata.clone(),
                        accounts.clone(),
                    );
                row.upsert(pool).await?;
                Ok(())
            }
            LiquidityInstruction::CpiEvent(instruction) => {
                let row = cpi_event_row::CpiEventRow::from_parts(
                    (**instruction).clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
        }
    }
}
