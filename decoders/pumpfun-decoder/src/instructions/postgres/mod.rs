//! This code was AUTOGENERATED using the Codama library.
pub mod admin_set_creator_row;
pub mod admin_set_idl_authority_row;
pub mod admin_update_token_incentives_row;
pub mod buy_exact_sol_in_row;
pub mod buy_row;
pub mod claim_token_incentives_row;
pub mod close_user_volume_accumulator_row;
pub mod collect_creator_fee_row;
pub mod cpi_event_row;
pub mod create_row;
pub mod create_v2_row;
pub mod extend_account_row;
pub mod init_user_volume_accumulator_row;
pub mod initialize_row;
pub mod migrate_row;
pub mod sell_row;
pub mod set_creator_row;
pub mod set_mayhem_virtual_params_row;
pub mod set_metaplex_creator_row;
pub mod set_params_row;
pub mod set_reserved_fee_recipients_row;
pub mod sync_user_volume_accumulator_row;
pub mod toggle_create_v2_row;
pub mod toggle_mayhem_mode_row;
pub mod update_global_authority_row;

pub use self::{
    admin_set_creator_row::*, admin_set_idl_authority_row::*, admin_update_token_incentives_row::*,
    buy_exact_sol_in_row::*, buy_row::*, claim_token_incentives_row::*,
    close_user_volume_accumulator_row::*, collect_creator_fee_row::*, cpi_event_row::*,
    create_row::*, create_v2_row::*, extend_account_row::*, init_user_volume_accumulator_row::*,
    initialize_row::*, migrate_row::*, sell_row::*, set_creator_row::*,
    set_mayhem_virtual_params_row::*, set_metaplex_creator_row::*, set_params_row::*,
    set_reserved_fee_recipients_row::*, sync_user_volume_accumulator_row::*,
    toggle_create_v2_row::*, toggle_mayhem_mode_row::*, update_global_authority_row::*,
};
use super::PumpfunInstruction;

pub struct PumpfunInstructionsMigration;

impl sqlx_migrator::Migration<sqlx::Postgres> for PumpfunInstructionsMigration {
    fn app(&self) -> &str {
        "pumpfun"
    }

    fn name(&self) -> &str {
        "pumpfun_instructions"
    }

    fn operations(&self) -> Vec<Box<dyn sqlx_migrator::Operation<sqlx::Postgres>>> {
        vec![
            Box::new(AdminSetCreatorMigrationOperation),
            Box::new(AdminSetIdlAuthorityMigrationOperation),
            Box::new(AdminUpdateTokenIncentivesMigrationOperation),
            Box::new(BuyMigrationOperation),
            Box::new(BuyExactSolInMigrationOperation),
            Box::new(ClaimTokenIncentivesMigrationOperation),
            Box::new(CloseUserVolumeAccumulatorMigrationOperation),
            Box::new(CollectCreatorFeeMigrationOperation),
            Box::new(CreateMigrationOperation),
            Box::new(CreateV2MigrationOperation),
            Box::new(ExtendAccountMigrationOperation),
            Box::new(InitializeMigrationOperation),
            Box::new(InitUserVolumeAccumulatorMigrationOperation),
            Box::new(MigrateMigrationOperation),
            Box::new(SellMigrationOperation),
            Box::new(SetCreatorMigrationOperation),
            Box::new(SetMayhemVirtualParamsMigrationOperation),
            Box::new(SetMetaplexCreatorMigrationOperation),
            Box::new(SetParamsMigrationOperation),
            Box::new(SetReservedFeeRecipientsMigrationOperation),
            Box::new(SyncUserVolumeAccumulatorMigrationOperation),
            Box::new(ToggleCreateV2MigrationOperation),
            Box::new(ToggleMayhemModeMigrationOperation),
            Box::new(UpdateGlobalAuthorityMigrationOperation),
            Box::new(CpiEventMigrationOperation),
        ]
    }

    fn parents(&self) -> Vec<Box<dyn sqlx_migrator::Migration<sqlx::Postgres>>> {
        vec![]
    }
}

pub struct PumpfunInstructionWithMetadata(
    pub PumpfunInstruction,
    pub carbon_core::instruction::InstructionMetadata,
    pub Vec<solana_instruction::AccountMeta>,
);

impl
    From<(
        PumpfunInstruction,
        carbon_core::instruction::InstructionMetadata,
        Vec<solana_instruction::AccountMeta>,
    )> for PumpfunInstructionWithMetadata
{
    fn from(
        value: (
            PumpfunInstruction,
            carbon_core::instruction::InstructionMetadata,
            Vec<solana_instruction::AccountMeta>,
        ),
    ) -> Self {
        PumpfunInstructionWithMetadata(value.0, value.1, value.2)
    }
}

#[async_trait::async_trait]
impl carbon_core::postgres::operations::Insert for PumpfunInstructionWithMetadata {
    async fn insert(&self, pool: &sqlx::PgPool) -> carbon_core::error::CarbonResult<()> {
        let PumpfunInstructionWithMetadata(instruction, metadata, accounts) = self;
        match instruction {
            PumpfunInstruction::AdminSetCreator(instruction) => {
                let row = admin_set_creator_row::AdminSetCreatorRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::AdminSetIdlAuthority(instruction) => {
                let row = admin_set_idl_authority_row::AdminSetIdlAuthorityRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::AdminUpdateTokenIncentives(instruction) => {
                let row =
                    admin_update_token_incentives_row::AdminUpdateTokenIncentivesRow::from_parts(
                        instruction.clone(),
                        metadata.clone(),
                        accounts.clone(),
                    );
                row.insert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::Buy(instruction) => {
                let row = buy_row::BuyRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::BuyExactSolIn(instruction) => {
                let row = buy_exact_sol_in_row::BuyExactSolInRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::ClaimTokenIncentives(instruction) => {
                let row = claim_token_incentives_row::ClaimTokenIncentivesRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::CloseUserVolumeAccumulator(instruction) => {
                let row =
                    close_user_volume_accumulator_row::CloseUserVolumeAccumulatorRow::from_parts(
                        instruction.clone(),
                        metadata.clone(),
                        accounts.clone(),
                    );
                row.insert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::CollectCreatorFee(instruction) => {
                let row = collect_creator_fee_row::CollectCreatorFeeRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::Create(instruction) => {
                let row = create_row::CreateRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::CreateV2(instruction) => {
                let row = create_v2_row::CreateV2Row::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::ExtendAccount(instruction) => {
                let row = extend_account_row::ExtendAccountRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::InitUserVolumeAccumulator(instruction) => {
                let row =
                    init_user_volume_accumulator_row::InitUserVolumeAccumulatorRow::from_parts(
                        instruction.clone(),
                        metadata.clone(),
                        accounts.clone(),
                    );
                row.insert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::Initialize(instruction) => {
                let row = initialize_row::InitializeRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::Migrate(instruction) => {
                let row = migrate_row::MigrateRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::Sell(instruction) => {
                let row = sell_row::SellRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::SetCreator(instruction) => {
                let row = set_creator_row::SetCreatorRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::SetMayhemVirtualParams(instruction) => {
                let row = set_mayhem_virtual_params_row::SetMayhemVirtualParamsRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::SetMetaplexCreator(instruction) => {
                let row = set_metaplex_creator_row::SetMetaplexCreatorRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::SetParams(instruction) => {
                let row = set_params_row::SetParamsRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::SetReservedFeeRecipients(instruction) => {
                let row = set_reserved_fee_recipients_row::SetReservedFeeRecipientsRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::SyncUserVolumeAccumulator(instruction) => {
                let row =
                    sync_user_volume_accumulator_row::SyncUserVolumeAccumulatorRow::from_parts(
                        instruction.clone(),
                        metadata.clone(),
                        accounts.clone(),
                    );
                row.insert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::ToggleCreateV2(instruction) => {
                let row = toggle_create_v2_row::ToggleCreateV2Row::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::ToggleMayhemMode(instruction) => {
                let row = toggle_mayhem_mode_row::ToggleMayhemModeRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::UpdateGlobalAuthority(instruction) => {
                let row = update_global_authority_row::UpdateGlobalAuthorityRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::CpiEvent(instruction) => {
                let row = cpi_event_row::CpiEventRow::from_parts(
                    (**instruction).clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
        }
    }
}

#[async_trait::async_trait]
impl carbon_core::postgres::operations::Upsert for PumpfunInstructionWithMetadata {
    async fn upsert(&self, pool: &sqlx::PgPool) -> carbon_core::error::CarbonResult<()> {
        let PumpfunInstructionWithMetadata(instruction, metadata, accounts) = self;
        match instruction {
            PumpfunInstruction::AdminSetCreator(instruction) => {
                let row = admin_set_creator_row::AdminSetCreatorRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::AdminSetIdlAuthority(instruction) => {
                let row = admin_set_idl_authority_row::AdminSetIdlAuthorityRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::AdminUpdateTokenIncentives(instruction) => {
                let row =
                    admin_update_token_incentives_row::AdminUpdateTokenIncentivesRow::from_parts(
                        instruction.clone(),
                        metadata.clone(),
                        accounts.clone(),
                    );
                row.upsert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::Buy(instruction) => {
                let row = buy_row::BuyRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::BuyExactSolIn(instruction) => {
                let row = buy_exact_sol_in_row::BuyExactSolInRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::ClaimTokenIncentives(instruction) => {
                let row = claim_token_incentives_row::ClaimTokenIncentivesRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::CloseUserVolumeAccumulator(instruction) => {
                let row =
                    close_user_volume_accumulator_row::CloseUserVolumeAccumulatorRow::from_parts(
                        instruction.clone(),
                        metadata.clone(),
                        accounts.clone(),
                    );
                row.upsert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::CollectCreatorFee(instruction) => {
                let row = collect_creator_fee_row::CollectCreatorFeeRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::Create(instruction) => {
                let row = create_row::CreateRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::CreateV2(instruction) => {
                let row = create_v2_row::CreateV2Row::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::ExtendAccount(instruction) => {
                let row = extend_account_row::ExtendAccountRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::InitUserVolumeAccumulator(instruction) => {
                let row =
                    init_user_volume_accumulator_row::InitUserVolumeAccumulatorRow::from_parts(
                        instruction.clone(),
                        metadata.clone(),
                        accounts.clone(),
                    );
                row.upsert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::Initialize(instruction) => {
                let row = initialize_row::InitializeRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::Migrate(instruction) => {
                let row = migrate_row::MigrateRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::Sell(instruction) => {
                let row = sell_row::SellRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::SetCreator(instruction) => {
                let row = set_creator_row::SetCreatorRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::SetMayhemVirtualParams(instruction) => {
                let row = set_mayhem_virtual_params_row::SetMayhemVirtualParamsRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::SetMetaplexCreator(instruction) => {
                let row = set_metaplex_creator_row::SetMetaplexCreatorRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::SetParams(instruction) => {
                let row = set_params_row::SetParamsRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::SetReservedFeeRecipients(instruction) => {
                let row = set_reserved_fee_recipients_row::SetReservedFeeRecipientsRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::SyncUserVolumeAccumulator(instruction) => {
                let row =
                    sync_user_volume_accumulator_row::SyncUserVolumeAccumulatorRow::from_parts(
                        instruction.clone(),
                        metadata.clone(),
                        accounts.clone(),
                    );
                row.upsert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::ToggleCreateV2(instruction) => {
                let row = toggle_create_v2_row::ToggleCreateV2Row::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::ToggleMayhemMode(instruction) => {
                let row = toggle_mayhem_mode_row::ToggleMayhemModeRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::UpdateGlobalAuthority(instruction) => {
                let row = update_global_authority_row::UpdateGlobalAuthorityRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            PumpfunInstruction::CpiEvent(instruction) => {
                let row = cpi_event_row::CpiEventRow::from_parts(
                    (**instruction).clone(),
                    metadata.clone(),
                    accounts.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
        }
    }
}
